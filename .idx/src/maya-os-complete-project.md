# Maya OS - Complete x86 Operating System Project Structure

## Project Directory Structure

```
maya-os/
â”œâ”€â”€ README.md
â”œâ”€â”€ Makefile
â”œâ”€â”€ linker.ld
â”œâ”€â”€ grub.cfg
â”œâ”€â”€ boot/
â”‚   â”œâ”€â”€ boot.asm
â”‚   â”œâ”€â”€ gdt.asm
â”‚   â””â”€â”€ idt.asm
â”œâ”€â”€ include/
â”‚   â”œâ”€â”€ kernel/
â”‚   â”‚   â”œâ”€â”€ kernel.h
â”‚   â”‚   â”œâ”€â”€ memory.h
â”‚   â”‚   â”œâ”€â”€ interrupts.h
â”‚   â”‚   â”œâ”€â”€ process.h
â”‚   â”‚   â””â”€â”€ timer.h
â”‚   â”œâ”€â”€ drivers/
â”‚   â”‚   â”œâ”€â”€ vga.h
â”‚   â”‚   â”œâ”€â”€ keyboard.h
â”‚   â”‚   â”œâ”€â”€ serial.h
â”‚   â”‚   â””â”€â”€ ata.h
â”‚   â”œâ”€â”€ libc/
â”‚   â”‚   â”œâ”€â”€ string.h
â”‚   â”‚   â”œâ”€â”€ stdio.h
â”‚   â”‚   â””â”€â”€ stdlib.h
â”‚   â”œâ”€â”€ gui/
â”‚   â”‚   â”œâ”€â”€ window.h
â”‚   â”‚   â”œâ”€â”€ graphics.h
â”‚   â”‚   â””â”€â”€ widgets.h
â”‚   â””â”€â”€ fs/
â”‚       â”œâ”€â”€ fat32.h
â”‚       â””â”€â”€ vfs.h
â”œâ”€â”€ kernel/
â”‚   â”œâ”€â”€ kernel.c
â”‚   â”œâ”€â”€ memory.c
â”‚   â”œâ”€â”€ interrupts.c
â”‚   â”œâ”€â”€ keyboard.c
â”‚   â”œâ”€â”€ timer.c
â”‚   â””â”€â”€ process.c
â”œâ”€â”€ drivers/
â”‚   â”œâ”€â”€ vga.c
â”‚   â”œâ”€â”€ serial.c
â”‚   â”œâ”€â”€ pci.c
â”‚   â””â”€â”€ ata.c
â”œâ”€â”€ libc/
â”‚   â”œâ”€â”€ string.c
â”‚   â”œâ”€â”€ stdio.c
â”‚   â”œâ”€â”€ stdlib.c
â”‚   â””â”€â”€ memory.c
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ window.c
â”‚   â”œâ”€â”€ graphics.c
â”‚   â”œâ”€â”€ widgets.c
â”‚   â””â”€â”€ desktop.c
â”œâ”€â”€ fs/
â”‚   â”œâ”€â”€ fat32.c
â”‚   â”œâ”€â”€ vfs.c
â”‚   â””â”€â”€ file.c
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ shell/
â”‚   â”‚   â””â”€â”€ shell.c
â”‚   â””â”€â”€ editor/
â”‚       â””â”€â”€ editor.c
â””â”€â”€ tools/
    â”œâ”€â”€ make-img.sh
        â””â”€â”€ debug.sh
        ```

        ---

        ## File Contents

        ### README.md
        ```markdown
        # Maya OS - x86 Operating System

        A complete x86 operating system with GUI, built from scratch.

        ## Features
        - Custom bootloader
        - 32-bit protected mode kernel
        - Memory management
        - Interrupt handling
        - Keyboard and mouse support
        - Basic GUI system
        - File system support
        - Multi-tasking

        ## Build Instructions
        1. Install dependencies: `sudo apt-get install build-essential nasm qemu-system-x86 genisoimage`
        2. Run `make` to build the OS
        3. Run `make run` to test in QEMU

        ## Project Structure
        - boot/ - Bootloader files
        - kernel/ - Kernel source code
        - drivers/ - Hardware drivers
        - libc/ - Standard C library implementation
        - gui/ - Graphics user interface
        - apps/ - User applications
        - fs/ - File system implementation
        - tools/ - Build tools and utilities
        ```

        ### Makefile
        ```makefile
        # Maya OS Makefile
        # Build configuration
        CC = i686-elf-gcc
        ASM = nasm
        LD = i686-elf-ld
        QEMU = qemu-system-i386

        # Directories
        SRCDIR = .
        BUILDDIR = build
        ISODIR = $(BUILDDIR)/iso
        BOOTDIR = $(ISODIR)/boot

        # Compiler flags
        CFLAGS = -m32 -nostdlib -nostdinc -fno-builtin -fno-stack-protector \
                 -nostartfiles -nodefaultlibs -Wall -Wextra -Werror -c -ffreestanding
                 LDFLAGS = -T linker.ld -melf_i386
                 ASMFLAGS = -f elf32

                 # Source files
                 BOOT_ASM = boot/boot.asm boot/gdt.asm boot/idt.asm
                 KERNEL_C = kernel/kernel.c kernel/memory.c kernel/interrupts.c kernel/keyboard.c \
                            kernel/timer.c kernel/process.c
                            DRIVER_C = drivers/vga.c drivers/serial.c drivers/pci.c drivers/ata.c
                            LIBC_C = libc/string.c libc/stdio.c libc/stdlib.c libc/memory.c
                            GUI_C = gui/window.c gui/graphics.c gui/widgets.c gui/desktop.c
                            FS_C = fs/fat32.c fs/vfs.c fs/file.c

                            # Object files
                            BOOT_OBJ = $(BOOT_ASM:%.asm=$(BUILDDIR)/%.o)
                            KERNEL_OBJ = $(KERNEL_C:%.c=$(BUILDDIR)/%.o)
                            DRIVER_OBJ = $(DRIVER_C:%.c=$(BUILDDIR)/%.o)
                            LIBC_OBJ = $(LIBC_C:%.c=$(BUILDDIR)/%.o)
                            GUI_OBJ = $(GUI_C:%.c=$(BUILDDIR)/%.o)
                            FS_OBJ = $(FS_C:%.c=$(BUILDDIR)/%.o)

                            ALL_OBJ = $(BOOT_OBJ) $(KERNEL_OBJ) $(DRIVER_OBJ) $(LIBC_OBJ) $(GUI_OBJ) $(FS_OBJ)

                            # Default target
                            all: maya-os.iso

                            # Create ISO image
                            maya-os.iso: $(BUILDDIR)/kernel.bin
                            	mkdir -p $(BOOTDIR)/grub
                                	cp $(BUILDDIR)/kernel.bin $(BOOTDIR)/
                                    	cp grub.cfg $(BOOTDIR)/grub/
                                        	grub-mkrescue -o maya-os.iso $(ISODIR)

                                            # Link kernel
                                            $(BUILDDIR)/kernel.bin: $(ALL_OBJ) | $(BUILDDIR)
                                            	$(LD) $(LDFLAGS) $(ALL_OBJ) -o $@

                                                # Compile C source files
                                                $(BUILDDIR)/%.o: %.c | $(BUILDDIR)
                                                	@mkdir -p $(dir $@)
                                                    	$(CC) $(CFLAGS) -I include $< -o $@

                                                        # Assemble ASM files
                                                        $(BUILDDIR)/%.o: %.asm | $(BUILDDIR)
                                                        	@mkdir -p $(dir $@)
                                                            	$(ASM) $(ASMFLAGS) $< -o $@

                                                                # Create build directory
                                                                $(BUILDDIR):
                                                                	mkdir -p $(BUILDDIR)

                                                                    # Run in QEMU
                                                                    run: maya-os.iso
                                                                    	$(QEMU) -cdrom maya-os.iso -m 256M -enable-kvm

                                                                        # Debug in QEMU
                                                                        debug: maya-os.iso
                                                                        	$(QEMU) -cdrom maya-os.iso -m 256M -s -S

                                                                            # Clean build files
                                                                            clean:
                                                                            	rm -rf $(BUILDDIR) maya-os.iso

                                                                                # Install cross-compiler
                                                                                install-toolchain:
                                                                                	@echo "Installing i686-elf cross-compiler..."
                                                                                    	@echo "Please follow: https://wiki.osdev.org/GCC_Cross-Compiler"

                                                                                        .PHONY: all run debug clean install-toolchain
                                                                                        ```

                                                                                        ### linker.ld
                                                                                        ```ld
                                                                                        /* Maya OS Kernel Linker Script */
                                                                                        ENTRY(kernel_main)

                                                                                        SECTIONS
                                                                                        {
                                                                                            . = 0x100000;

                                                                                                .text ALIGN(4K) : {
                                                                                                        *(.multiboot)
                                                                                                                *(.text)
                                                                                                                    }

                                                                                                                        .rodata ALIGN(4K) : {
                                                                                                                                *(.rodata*)
                                                                                                                                    }

                                                                                                                                        .data ALIGN(4K) : {
                                                                                                                                                *(.data)
                                                                                                                                                    }

                                                                                                                                                        .bss ALIGN(4K) : {
                                                                                                                                                                *(COMMON)
                                                                                                                                                                        *(.bss)
                                                                                                                                                                                *(.bootstrap_stack)
                                                                                                                                                                                    }

                                                                                                                                                                                        /DISCARD/ : {
                                                                                                                                                                                                *(.comment)
                                                                                                                                                                                                        *(.eh_frame)
                                                                                                                                                                                                            }
                                                                                                                                                                                                            }
                                                                                                                                                                                                            ```

                                                                                                                                                                                                            ### grub.cfg
                                                                                                                                                                                                            ```
                                                                                                                                                                                                            menuentry "Maya OS" {
                                                                                                                                                                                                                multiboot /kernel.bin
                                                                                                                                                                                                                    boot
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                    ### boot/boot.asm
                                                                                                                                                                                                                    ```nasm
                                                                                                                                                                                                                    ;;; Maya OS Bootloader
                                                                                                                                                                                                                    ;;; Multiboot compliant boot sector

                                                                                                                                                                                                                    MBOOT_PAGE_ALIGN    equ 1<<0
                                                                                                                                                                                                                    MBOOT_MEM_INFO      equ 1<<1
                                                                                                                                                                                                                    MBOOT_HEADER_MAGIC  equ 0x1BADB002
                                                                                                                                                                                                                    MBOOT_HEADER_FLAGS  equ MBOOT_PAGE_ALIGN | MBOOT_MEM_INFO
                                                                                                                                                                                                                    MBOOT_CHECKSUM      equ -(MBOOT_HEADER_MAGIC + MBOOT_HEADER_FLAGS)

                                                                                                                                                                                                                    [BITS 32]

                                                                                                                                                                                                                    section .multiboot
                                                                                                                                                                                                                    align 4
                                                                                                                                                                                                                        dd MBOOT_HEADER_MAGIC
                                                                                                                                                                                                                            dd MBOOT_HEADER_FLAGS
                                                                                                                                                                                                                                dd MBOOT_CHECKSUM

                                                                                                                                                                                                                                section .text
                                                                                                                                                                                                                                global _start
                                                                                                                                                                                                                                extern kernel_main
                                                                                                                                                                                                                                extern gdt_flush
                                                                                                                                                                                                                                extern idt_install

                                                                                                                                                                                                                                _start:
                                                                                                                                                                                                                                    ; Set up stack
                                                                                                                                                                                                                                        mov esp, stack_top
                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                ; Push multiboot info to stack for kernel
                                                                                                                                                                                                                                                    push ebx    ; Multiboot info structure
                                                                                                                                                                                                                                                        push eax    ; Multiboot magic number
                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                ; Initialize GDT and IDT
                                                                                                                                                                                                                                                                    call gdt_flush
                                                                                                                                                                                                                                                                        call idt_install
                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                ; Enable interrupts
                                                                                                                                                                                                                                                                                    sti
                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                            ; Call kernel main
                                                                                                                                                                                                                                                                                                call kernel_main
                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                        ; Halt if kernel returns
                                                                                                                                                                                                                                                                                                        .halt:
                                                                                                                                                                                                                                                                                                            cli
                                                                                                                                                                                                                                                                                                                hlt
                                                                                                                                                                                                                                                                                                                    jmp .halt

                                                                                                                                                                                                                                                                                                                    section .bss
                                                                                                                                                                                                                                                                                                                    align 16
                                                                                                                                                                                                                                                                                                                    stack_bottom:
                                                                                                                                                                                                                                                                                                                    resb 16384  ; 16 KiB stack
                                                                                                                                                                                                                                                                                                                    stack_top:
                                                                                                                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                                                                                                                    ### boot/gdt.asm
                                                                                                                                                                                                                                                                                                                    ```nasm
                                                                                                                                                                                                                                                                                                                    ;;; Global Descriptor Table Setup

                                                                                                                                                                                                                                                                                                                    [BITS 32]
                                                                                                                                                                                                                                                                                                                    section .text

                                                                                                                                                                                                                                                                                                                    global gdt_flush
                                                                                                                                                                                                                                                                                                                    extern gp

                                                                                                                                                                                                                                                                                                                    gdt_flush:
                                                                                                                                                                                                                                                                                                                        lgdt [gp]        ; Load GDT
                                                                                                                                                                                                                                                                                                                            mov ax, 0x10     ; Data segment offset
                                                                                                                                                                                                                                                                                                                                mov ds, ax
                                                                                                                                                                                                                                                                                                                                    mov es, ax
                                                                                                                                                                                                                                                                                                                                        mov fs, ax
                                                                                                                                                                                                                                                                                                                                            mov gs, ax
                                                                                                                                                                                                                                                                                                                                                mov ss, ax
                                                                                                                                                                                                                                                                                                                                                    jmp 0x08:flush2  ; Code segment offset
                                                                                                                                                                                                                                                                                                                                                    flush2:
                                                                                                                                                                                                                                                                                                                                                        ret
                                                                                                                                                                                                                                                                                                                                                        ```

                                                                                                                                                                                                                                                                                                                                                        ### boot/idt.asm
                                                                                                                                                                                                                                                                                                                                                        ```nasm
                                                                                                                                                                                                                                                                                                                                                        ;;; Interrupt Descriptor Table Setup

                                                                                                                                                                                                                                                                                                                                                        [BITS 32]
                                                                                                                                                                                                                                                                                                                                                        section .text

                                                                                                                                                                                                                                                                                                                                                        global idt_load
                                                                                                                                                                                                                                                                                                                                                        global isr0, isr1, isr2, isr3, isr4, isr5, isr6, isr7
                                                                                                                                                                                                                                                                                                                                                        global isr8, isr9, isr10, isr11, isr12, isr13, isr14, isr15
                                                                                                                                                                                                                                                                                                                                                        global isr16, isr17, isr18, isr19, isr20, isr21, isr22, isr23
                                                                                                                                                                                                                                                                                                                                                        global isr24, isr25, isr26, isr27, isr28, isr29, isr30, isr31
                                                                                                                                                                                                                                                                                                                                                        global irq0, irq1, irq2, irq3, irq4, irq5, irq6, irq7
                                                                                                                                                                                                                                                                                                                                                        global irq8, irq9, irq10, irq11, irq12, irq13, irq14, irq15

                                                                                                                                                                                                                                                                                                                                                        idt_load:
                                                                                                                                                                                                                                                                                                                                                            lidt [idtp]
                                                                                                                                                                                                                                                                                                                                                                ret

                                                                                                                                                                                                                                                                                                                                                                ; ISR macros
                                                                                                                                                                                                                                                                                                                                                                %macro ISR_NOERRCODE 1
                                                                                                                                                                                                                                                                                                                                                                isr%1:
                                                                                                                                                                                                                                                                                                                                                                    cli
                                                                                                                                                                                                                                                                                                                                                                        push byte 0
                                                                                                                                                                                                                                                                                                                                                                            push byte %1
                                                                                                                                                                                                                                                                                                                                                                                jmp isr_common_stub
                                                                                                                                                                                                                                                                                                                                                                                %endmacro

                                                                                                                                                                                                                                                                                                                                                                                %macro ISR_ERRCODE 1
                                                                                                                                                                                                                                                                                                                                                                                isr%1:
                                                                                                                                                                                                                                                                                                                                                                                    cli
                                                                                                                                                                                                                                                                                                                                                                                        push byte %1
                                                                                                                                                                                                                                                                                                                                                                                            jmp isr_common_stub
                                                                                                                                                                                                                                                                                                                                                                                            %endmacro

                                                                                                                                                                                                                                                                                                                                                                                            %macro IRQ 2
                                                                                                                                                                                                                                                                                                                                                                                            irq%1:
                                                                                                                                                                                                                                                                                                                                                                                                cli
                                                                                                                                                                                                                                                                                                                                                                                                    push byte 0
                                                                                                                                                                                                                                                                                                                                                                                                        push byte %2
                                                                                                                                                                                                                                                                                                                                                                                                            jmp irq_common_stub
                                                                                                                                                                                                                                                                                                                                                                                                            %endmacro

                                                                                                                                                                                                                                                                                                                                                                                                            ; ISRs without error codes
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 0
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 1
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 2
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 3
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 4
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 5
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 6
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 7
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_ERRCODE   8
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 9
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_ERRCODE   10
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_ERRCODE   11
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_ERRCODE   12
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_ERRCODE   13
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_ERRCODE   14
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 15
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 16
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 17
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 18
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 19
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 20
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 21
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 22
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 23
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 24
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 25
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 26
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 27
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 28
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 29
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 30
                                                                                                                                                                                                                                                                                                                                                                                                            ISR_NOERRCODE 31

                                                                                                                                                                                                                                                                                                                                                                                                            ; IRQs
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 0, 32
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 1, 33
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 2, 34
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 3, 35
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 4, 36
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 5, 37
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 6, 38
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 7, 39
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 8, 40
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 9, 41
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 10, 42
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 11, 43
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 12, 44
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 13, 45
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 14, 46
                                                                                                                                                                                                                                                                                                                                                                                                            IRQ 15, 47

                                                                                                                                                                                                                                                                                                                                                                                                            extern isr_handler
                                                                                                                                                                                                                                                                                                                                                                                                            isr_common_stub:
                                                                                                                                                                                                                                                                                                                                                                                                                pusha
                                                                                                                                                                                                                                                                                                                                                                                                                    push ds
                                                                                                                                                                                                                                                                                                                                                                                                                        push es
                                                                                                                                                                                                                                                                                                                                                                                                                            push fs
                                                                                                                                                                                                                                                                                                                                                                                                                                push gs
                                                                                                                                                                                                                                                                                                                                                                                                                                    mov ax, 0x10
                                                                                                                                                                                                                                                                                                                                                                                                                                        mov ds, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                            mov es, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                mov fs, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                    mov gs, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                        mov eax, esp
                                                                                                                                                                                                                                                                                                                                                                                                                                                            push eax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                mov eax, isr_handler
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    call eax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        pop eax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            pop gs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                pop fs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pop es
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        pop ds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            popa
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                add esp, 8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    iret

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    extern irq_handler
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    irq_common_stub:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        pusha
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            push ds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                push es
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push fs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        push gs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            mov ax, 0x10
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                mov ds, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    mov es, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        mov fs, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            mov gs, ax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                mov eax, esp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push eax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        mov eax, irq_handler
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            call eax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                pop eax
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pop gs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        pop fs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            pop es
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                pop ds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    popa
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        add esp, 8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            iret

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            section .data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            idtp:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                dw 2048
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    dd 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ### include/kernel/kernel.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #ifndef KERNEL_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KERNEL_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #include <stdint.h>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #include <stddef.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Multiboot structures
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    struct multiboot_info {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t flags;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t mem_lower;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t mem_upper;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t boot_device;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t cmdline;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t mods_count;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t mods_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t syms[4];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t mmap_length;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t mmap_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t drives_length;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t drives_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t config_table;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t boot_loader_name;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t apm_table;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t vbe_control_info;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t vbe_mode_info;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t vbe_mode;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t vbe_interface_seg;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t vbe_interface_off;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t vbe_interface_len;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } __attribute__((packed));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // System information
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        extern struct multiboot_info *mbi;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        extern uint32_t initial_esp;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Kernel functions
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void kernel_main(uint32_t magic, struct multiboot_info *mbi);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void kernel_panic(const char *message);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void outb(uint16_t port, uint8_t value);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint8_t inb(uint16_t port);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void outw(uint16_t port, uint16_t value);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint16_t inw(uint16_t port);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Debug functions
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void debug_print(const char *message);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void debug_print_hex(uint32_t value);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ### include/kernel/memory.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #ifndef MEMORY_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define MEMORY_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #include <stdint.h>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #include <stddef.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define PAGE_SIZE 4096
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define PAGE_ALIGN(addr) (((addr) + PAGE_SIZE - 1) & ~(PAGE_SIZE - 1))

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Memory map entry
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct memory_map_entry {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t size;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint64_t address;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint64_t length;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } __attribute__((packed));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Physical memory manager
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void pmm_init(struct multiboot_info *mbi);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void *pmm_alloc_page(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void pmm_free_page(void *page);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t pmm_get_total_memory(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t pmm_get_used_memory(void);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Virtual memory manager
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void vmm_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void *vmm_alloc(size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void vmm_free(void *ptr);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void vmm_map_page(uint32_t virtual, uint32_t physical, uint32_t flags);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void vmm_unmap_page(uint32_t virtual);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Heap
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void heap_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void *kmalloc(size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void *kcalloc(size_t nmemb, size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void *krealloc(void *ptr, size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void kfree(void *ptr);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ### include/kernel/interrupts.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #ifndef INTERRUPTS_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define INTERRUPTS_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // IDT entry structure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct idt_entry {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint16_t base_lo;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint16_t sel;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint8_t always0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint8_t flags;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint16_t base_hi;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } __attribute__((packed));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // IDT pointer structure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            struct idt_ptr {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint16_t limit;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t base;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } __attribute__((packed));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Register structure for interrupt handlers
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    struct registers {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t gs, fs, es, ds;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t edi, esi, ebp, esp, ebx, edx, ecx, eax;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t int_no, err_code;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t eip, cs, eflags, useresp, ss;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } __attribute__((packed));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Function prototypes
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void idt_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void idt_install(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void idt_set_gate(uint8_t num, uint32_t base, uint16_t sel, uint8_t flags);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void isr_handler(struct registers *regs);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void irq_handler(struct registers *regs);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    typedef void (*isr_t)(struct registers *);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void register_interrupt_handler(uint8_t n, isr_t handler);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // PIC functions
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void pic_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void pic_send_eoi(uint8_t irq);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ### include/kernel/process.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #ifndef PROCESS_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define PROCESS_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define MAX_PROCESSES 256

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    typedef enum {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PROCESS_STATE_READY,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PROCESS_STATE_RUNNING,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                PROCESS_STATE_BLOCKED,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PROCESS_STATE_TERMINATED
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } process_state_t;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    struct process {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t pid;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            process_state_t state;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint32_t esp;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t ebp;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t eip;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            uint32_t page_directory;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct process *next;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    char name[256];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } __attribute__((packed));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Process management
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void process_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t process_create(void (*entry_point)(void), const char *name);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void process_kill(uint32_t pid);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void process_switch(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    struct process *process_get_current(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void schedule(void);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // System calls
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void syscall_init(void);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ### include/kernel/timer.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #ifndef TIMER_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define TIMER_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void timer_init(uint32_t frequency);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint32_t timer_get_tick(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void timer_wait(uint32_t ticks);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void sleep(uint32_t ms);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ### include/drivers/vga.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #ifndef VGA_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define VGA_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // VGA colors
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    typedef enum {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        VGA_COLOR_BLACK = 0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            VGA_COLOR_BLUE = 1,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                VGA_COLOR_GREEN = 2,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    VGA_COLOR_CYAN = 3,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        VGA_COLOR_RED = 4,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            VGA_COLOR_MAGENTA = 5,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                VGA_COLOR_BROWN = 6,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    VGA_COLOR_LIGHT_GREY = 7,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        VGA_COLOR_DARK_GREY = 8,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            VGA_COLOR_LIGHT_BLUE = 9,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                VGA_COLOR_LIGHT_GREEN = 10,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    VGA_COLOR_LIGHT_CYAN = 11,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        VGA_COLOR_LIGHT_RED = 12,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            VGA_COLOR_LIGHT_MAGENTA = 13,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                VGA_COLOR_LIGHT_BROWN = 14,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    VGA_COLOR_WHITE = 15,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } vga_color_t;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define VGA_WIDTH 80
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define VGA_HEIGHT 25

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_clear(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_putchar(char c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_write(const char *data, size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_writestring(const char *data);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_set_color(uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_set_cursor(size_t x, size_t y);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Graphics mode functions
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_set_mode_13h(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_put_pixel(int x, int y, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_draw_line(int x1, int y1, int x2, int y2, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void vga_draw_rect(int x, int y, int width, int height, uint8_t color);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ### include/drivers/keyboard.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #ifndef KEYBOARD_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEYBOARD_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEYBOARD_DATA_PORT 0x60
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEYBOARD_STATUS_PORT 0x64
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEYBOARD_COMMAND_PORT 0x64

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Key codes
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_ESC 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_1 2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_2 3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_3 4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_4 5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_5 6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_6 7
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_7 8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_8 9
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_9 10
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_0 11
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_MINUS 12
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_EQUALS 13
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_BACKSPACE 14
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_TAB 15
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_Q 16
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_W 17
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_E 18
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_R 19
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_T 20
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_Y 21
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_U 22
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_I 23
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_O 24
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_P 25
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_ENTER 28
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_CTRL 29
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_A 30
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_S 31
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_D 32
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_F 33
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_G 34
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_H 35
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_J 36
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_K 37
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_L 38
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_SHIFT 42
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_Z 44
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_X 45
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_C 46
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_V 47
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_B 48
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_N 49
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_M 50
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #define KEY_SPACE 57

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    typedef struct {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint8_t scancode;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            char ascii;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint8_t pressed;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } key_event_t;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void keyboard_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char keyboard_getchar(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                key_event_t keyboard_get_key(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint8_t keyboard_get_scancode(void);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ### include/drivers/serial.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #ifndef SERIAL_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define SERIAL_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define COM1 0x3F8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define COM2 0x2F8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define COM3 0x3E8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define COM4 0x2E8

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void serial_init(uint16_t port);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void serial_putchar(uint16_t port, char c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void serial_write(uint16_t port, const char *data, size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void serial_writestring(uint16_t port, const char *data);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char serial_getchar(uint16_t port);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint8_t serial_received(uint16_t port);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint8_t serial_is_transmit_empty(uint16_t port);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ### include/drivers/ata.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #ifndef ATA_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_DATA 0x1F0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_ERR 0x1F1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_SECCOUNT 0x1F2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_LBA_LO 0x1F3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_LBA_MID 0x1F4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_LBA_HI 0x1F5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_DRIVE_HEAD 0x1F6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_COMM_REGSTAT 0x1F7
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_PRIMARY_ALTSTAT_DEVCTRL 0x3F6

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_DATA 0x170
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_ERR 0x171
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_SECCOUNT 0x172
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_LBA_LO 0x173
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_LBA_MID 0x174
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_LBA_HI 0x175
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_DRIVE_HEAD 0x176
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_COMM_REGSTAT 0x177
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define ATA_SECONDARY_ALTSTAT_DEVCTRL 0x376

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define SECTOR_SIZE 512

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void ata_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void ata_read_sectors(uint8_t drive, uint32_t lba, uint8_t sectors, uint16_t *buffer);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void ata_write_sectors(uint8_t drive, uint32_t lba, uint8_t sectors, uint16_t *buffer);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void ata_identify(uint8_t drive);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ### include/libc/string.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #ifndef STRING_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define STRING_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stddef.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void *memcpy(void *dest, const void *src, size_t n);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void *memset(void *s, int c, size_t n);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void *memmove(void *dest, const void *src, size_t n);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int memcmp(const void *s1, const void *s2, size_t n);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                size_t strlen(const char *s);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strcpy(char *dest, const char *src);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strncpy(char *dest, const char *src, size_t n);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int strcmp(const char *s1, const char *s2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int strncmp(const char *s1, const char *s2, size_t n);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strcat(char *dest, const char *src);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strncat(char *dest, const char *src, size_t n);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strchr(const char *s, int c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strrchr(const char *s, int c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *strstr(const char *haystack, const char *needle);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ### include/libc/stdio.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #ifndef STDIO_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define STDIO_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stddef.h>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stdarg.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int printf(const char *format, ...);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int sprintf(char *str, const char *format, ...);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int snprintf(char *str, size_t size, const char *format, ...);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int vprintf(const char *format, va_list ap);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int vsprintf(char *str, const char *format, va_list ap);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int vsnprintf(char *str, size_t size, const char *format, va_list ap);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int putchar(int c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int puts(const char *s);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ### include/libc/stdlib.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #ifndef STDLIB_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define STDLIB_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stddef.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void *malloc(size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void *calloc(size_t nmemb, size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void *realloc(void *ptr, size_t size);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void free(void *ptr);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int atoi(const char *nptr);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                long atol(const char *nptr);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                long long atoll(const char *nptr);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int abs(int j);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                long labs(long j);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                long long llabs(long long j);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void qsort(void *base, size_t nmemb, size_t size, int (*compar)(const void *, const void *));

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ### include/gui/window.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #ifndef WINDOW_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #define WINDOW_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                typedef struct {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    int x, y;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        int width, height;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            char *title;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                uint8_t *buffer;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    uint8_t visible;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        uint32_t id;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } window_t;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        window_t *window_create(int x, int y, int width, int height, const char *title);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_destroy(window_t *window);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_show(window_t *window);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_hide(window_t *window);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_move(window_t *window, int x, int y);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_resize(window_t *window, int width, int height);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_set_title(window_t *window, const char *title);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_draw_pixel(window_t *window, int x, int y, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_draw_rect(window_t *window, int x, int y, int width, int height, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_clear(window_t *window, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void window_refresh(window_t *window);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ```

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ### include/gui/graphics.h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ```c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #ifndef GRAPHICS_H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define GRAPHICS_H

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #include <stdint.h>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define SCREEN_WIDTH 320
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #define SCREEN_HEIGHT 200

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void graphics_init(void);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void graphics_set_pixel(int x, int y, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void graphics_draw_line(int x1, int y1, int x2, int y2, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void graphics_draw_rect(int x, int y, int width, int height, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void graphics_fill_rect(int x, int y, int width, int height, uint8_t color);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void graphics_draw_circle(int c